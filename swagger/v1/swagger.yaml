---
openapi: 3.0.1
info:
  title: API V1
  version: v1
paths:
  "/api/confirm_email":
    post:
      summary: Confirm email
      tags:
      - Confirm email
      operationId: confirmEmail
      parameters: []
      responses:
        '204':
          description: No Content
        '404':
          description: Token not found
        '422':
          description: Invalid token
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
              required:
              - token
  "/api/session":
    post:
      summary: Sign in
      tags:
      - Authentication
      operationId: signIn
      parameters: []
      responses:
        '201':
          description: User authenticated
          content:
            application/json:
              example:
                data:
                  id: 3627c574-8227-40ef-9902-4893f7281725
                  type: session
                  attributes:
                    token: 3627c574-8227-40ef-9902-4893f7281725
                  relationships:
                    user:
                      data:
                        id: 67fdd497-9c6d-43fb-8fe1-7e38261d6186
                        type: user
                included:
                - id: 67fdd497-9c6d-43fb-8fe1-7e38261d6186
                  type: user
                  attributes:
                    email: user-2@example.com
                    emailConfirmed: false
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/session"
                  included:
                    type: array
                    items:
                      "$ref": "#/components/schemas/user"
        '404':
          description: Invalid credentials
          content:
            application/json:
              example:
                errors:
                - title: Either account is missing or password is invalid.
                  status: 404
                  code: NOT_FOUND
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                session:
                  type: object
                  properties:
                    email:
                      type: string
                      format: email
                    password:
                      type: string
                  required:
                  - email
                  - password
                required:
                - session
    delete:
      summary: Sign out
      tags:
      - Authentication
      operationId: signOut
      security:
      - bearer: []
      responses:
        '204':
          description: User signed out
  "/api/short_links":
    post:
      summary: Create short link
      tags:
      - Short links / create
      operationId: createShortLink
      security:
      - bearer: []
      parameters: []
      responses:
        '201':
          description: Short link created
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                shortLink:
                  type: object
                  properties:
                    url:
                      type: string
                  required:
                  - url
              required:
              - shortLink
  "/api/user":
    get:
      summary: Show
      tags:
      - User
      operationId: showUser
      security:
      - bearer: []
      responses:
        '200':
          description: Shown
          content:
            application/json:
              example:
                data:
                  id: f21b5e16-7c5f-417c-99af-0c2a9f036f12
                  type: user
                  attributes:
                    email: user-5@example.com
                    emailConfirmed: true
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/user"
  "/api/users":
    post:
      summary: Sign up
      tags:
      - Users
      operationId: signUp
      parameters: []
      responses:
        '201':
          description: User signed up
          content:
            application/json:
              example:
                data:
                  id: c3ca1d10-82d8-44a9-9756-dda075c75131
                  type: user
                  attributes:
                    email: new@user.com
                    emailConfirmed: false
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/user"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                user:
                  type: object
                  properties:
                    email:
                      type: string
                      format: email
                    password:
                      type: string
                  required:
                  - email
                  - password
              required:
              - user
components:
  securitySchemes:
    bearer:
      description: Key necessary to use API calls as authenticated user
      type: apiKey
      name: Authorization
      in: header
  schemas:
    auth_info:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
        attributes:
          type: object
          properties:
            email:
              type: string
              format: email
              nullable: true
    relationship_one:
      type: object
      properties:
        data:
          "$ref": "#/components/schemas/resource_identifier_object"
    resource_identifier_object:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
      required:
      - id
      - type
    session:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
        attributes:
          type: object
          properties:
            token:
              type: string
          required:
          - token
        relationships:
          type: object
          properties:
            user:
              "$ref": "#/components/schemas/relationship_one"
      required:
      - id
      - type
      - attributes
    user:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
        attributes:
          type: object
          properties:
            email:
              type: string
              format: email
            emailConfirmed:
              type: boolean
          required:
          - email
          - emailConfirmed
      required:
      - id
      - type
      - attributes
